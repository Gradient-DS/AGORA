{
  "description": "Tool approval flow with human-in-the-loop using AG-UI Protocol",
  "events": [
    {
      "direction": "client → server",
      "event": {
        "threadId": "abc123-def456-789",
        "runId": "run-002",
        "messages": [
          {
            "role": "user",
            "content": "Generate the inspection report for INS-2024-001"
          }
        ]
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "RUN_STARTED",
        "threadId": "abc123-def456-789",
        "runId": "run-002",
        "timestamp": "2025-01-15T10:30:00.000Z"
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "STEP_STARTED",
        "stepName": "routing",
        "metadata": { "message": "Analyzing request..." },
        "timestamp": "2025-01-15T10:30:00.100Z"
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "STEP_FINISHED",
        "stepName": "routing",
        "timestamp": "2025-01-15T10:30:00.300Z"
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "STEP_STARTED",
        "stepName": "thinking",
        "timestamp": "2025-01-15T10:30:00.400Z"
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "STEP_STARTED",
        "stepName": "executing_tools",
        "metadata": { "tool": "generate_final_report" },
        "timestamp": "2025-01-15T10:30:01.000Z"
      }
    },
    {
      "direction": "server → client",
      "description": "Tool approval request - server pauses and waits for client response",
      "event": {
        "type": "CUSTOM",
        "name": "agora:tool_approval_request",
        "value": {
          "toolName": "generate_final_report",
          "toolDescription": "Generates an official inspection report PDF that will be stored permanently in the system",
          "parameters": {
            "inspection_id": "INS-2024-001",
            "include_photos": true,
            "language": "nl"
          },
          "reasoning": "User requested to generate the final inspection report. This is a critical operation that creates an official document.",
          "riskLevel": "critical",
          "approvalId": "appr-xyz789"
        },
        "timestamp": "2025-01-15T10:30:01.100Z"
      }
    },
    {
      "direction": "client → server",
      "description": "User approves the tool execution",
      "event": {
        "type": "CUSTOM",
        "name": "agora:tool_approval_response",
        "value": {
          "approvalId": "appr-xyz789",
          "approved": true,
          "feedback": "Looks good, proceed with report generation"
        }
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "TOOL_CALL_START",
        "toolCallId": "call-report-001",
        "toolCallName": "generate_final_report",
        "parentMessageId": null,
        "timestamp": "2025-01-15T10:30:02.000Z"
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "TOOL_CALL_ARGS",
        "toolCallId": "call-report-001",
        "delta": "{\"inspection_id\": \"INS-2024-001\", \"include_photos\": true, \"language\": \"nl\"}",
        "timestamp": "2025-01-15T10:30:02.100Z"
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "TOOL_CALL_END",
        "toolCallId": "call-report-001",
        "result": "Report generated successfully: report-INS-2024-001.pdf",
        "timestamp": "2025-01-15T10:30:05.000Z"
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "STEP_FINISHED",
        "stepName": "executing_tools",
        "timestamp": "2025-01-15T10:30:05.100Z"
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "TEXT_MESSAGE_START",
        "messageId": "msg-002",
        "role": "assistant",
        "timestamp": "2025-01-15T10:30:05.200Z"
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "TEXT_MESSAGE_CONTENT",
        "messageId": "msg-002",
        "delta": "I have successfully generated the inspection report for INS-2024-001. You can download the PDF from the link below.",
        "timestamp": "2025-01-15T10:30:05.300Z"
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "TEXT_MESSAGE_END",
        "messageId": "msg-002",
        "timestamp": "2025-01-15T10:30:05.400Z"
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "STEP_FINISHED",
        "stepName": "thinking",
        "timestamp": "2025-01-15T10:30:05.500Z"
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "RUN_FINISHED",
        "threadId": "abc123-def456-789",
        "runId": "run-002",
        "timestamp": "2025-01-15T10:30:05.600Z"
      }
    }
  ]
}
