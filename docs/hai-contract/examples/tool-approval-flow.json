{
  "description": "Tool approval flow with human-in-the-loop using AG-UI Protocol v2.1.1",
  "events": [
    {
      "direction": "client → server",
      "event": {
        "threadId": "abc123-def456-789",
        "runId": "run-002",
        "messages": [
          {
            "role": "user",
            "content": "Generate the inspection report for INS-2024-001"
          }
        ]
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "RUN_STARTED",
        "threadId": "abc123-def456-789",
        "runId": "run-002",
        "timestamp": 1705318200000
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "STATE_SNAPSHOT",
        "snapshot": {
          "threadId": "abc123-def456-789",
          "runId": "run-002",
          "currentAgent": "general-agent",
          "status": "processing"
        },
        "timestamp": 1705318200050
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "STEP_STARTED",
        "stepName": "routing",
        "timestamp": 1705318200100
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "STEP_FINISHED",
        "stepName": "routing",
        "timestamp": 1705318200300
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "STEP_STARTED",
        "stepName": "thinking",
        "timestamp": 1705318200400
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "STEP_FINISHED",
        "stepName": "thinking",
        "timestamp": 1705318200900
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "STEP_STARTED",
        "stepName": "executing_tools",
        "timestamp": 1705318201000
      }
    },
    {
      "direction": "server → client",
      "description": "Tool approval request - server pauses and waits for client response",
      "event": {
        "type": "CUSTOM",
        "name": "agora:tool_approval_request",
        "value": {
          "toolName": "generate_final_report",
          "toolDescription": "Generates an official inspection report PDF that will be stored permanently in the system",
          "parameters": {
            "inspectionId": "INS-2024-001",
            "includePhotos": true,
            "language": "nl"
          },
          "reasoning": "User requested to generate the final inspection report. This is a critical operation that creates an official document.",
          "riskLevel": "critical",
          "approvalId": "appr-xyz789"
        },
        "timestamp": 1705318201100
      }
    },
    {
      "direction": "client → server",
      "description": "User approves the tool execution",
      "event": {
        "type": "CUSTOM",
        "name": "agora:tool_approval_response",
        "value": {
          "approvalId": "appr-xyz789",
          "approved": true,
          "feedback": "Looks good, proceed with report generation"
        }
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "TOOL_CALL_START",
        "toolCallId": "call-report-001",
        "toolCallName": "generate_final_report",
        "parentMessageId": null,
        "timestamp": 1705318202000
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "TOOL_CALL_ARGS",
        "toolCallId": "call-report-001",
        "delta": "{\"inspectionId\": \"INS-2024-001\", \"includePhotos\": true, \"language\": \"nl\"}",
        "timestamp": 1705318202100
      }
    },
    {
      "direction": "server → client",
      "description": "TOOL_CALL_END signals end of argument streaming",
      "event": {
        "type": "TOOL_CALL_END",
        "toolCallId": "call-report-001",
        "timestamp": 1705318204900
      }
    },
    {
      "direction": "server → client",
      "description": "TOOL_CALL_RESULT contains the actual execution result",
      "event": {
        "type": "TOOL_CALL_RESULT",
        "messageId": "tool-result-report-001",
        "toolCallId": "call-report-001",
        "content": "Report generated successfully: report-INS-2024-001.pdf",
        "role": "tool",
        "timestamp": 1705318205000
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "STEP_FINISHED",
        "stepName": "executing_tools",
        "timestamp": 1705318205100
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "STEP_STARTED",
        "stepName": "thinking",
        "timestamp": 1705318205150
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "TEXT_MESSAGE_START",
        "messageId": "msg-002",
        "role": "assistant",
        "timestamp": 1705318205200
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "TEXT_MESSAGE_CONTENT",
        "messageId": "msg-002",
        "delta": "I have successfully generated the inspection report for INS-2024-001. You can download the PDF from the link below.",
        "timestamp": 1705318205300
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "TEXT_MESSAGE_END",
        "messageId": "msg-002",
        "timestamp": 1705318205400
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "STEP_FINISHED",
        "stepName": "thinking",
        "timestamp": 1705318205500
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "STATE_SNAPSHOT",
        "snapshot": {
          "threadId": "abc123-def456-789",
          "runId": "run-002",
          "currentAgent": "reporting-agent",
          "status": "completed"
        },
        "timestamp": 1705318205550
      }
    },
    {
      "direction": "server → client",
      "event": {
        "type": "RUN_FINISHED",
        "threadId": "abc123-def456-789",
        "runId": "run-002",
        "timestamp": 1705318205600
      }
    }
  ]
}
