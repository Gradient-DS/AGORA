services:
  company-compliance:
    platform: linux/arm64
    build:
      context: ./company-compliance
      dockerfile: Dockerfile
    image: mcp-company-compliance:latest
    container_name: mcp-company-compliance
    ports:
      - "5001:8000"
    networks:
      - agora-network
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "python", "-c", "import httpx; httpx.get('http://localhost:8000/health')"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 5s

  regulation-analysis:
    build:
      context: ./regulation-analysis
      dockerfile: Dockerfile
    image: mcp-regulation-analysis:latest
    container_name: mcp-regulation-analysis
    ports:
      - "5002:8000"
    networks:
      - agora-network
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "python", "-c", "import httpx; httpx.get('http://localhost:8000/health')"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 5s

  reporting:
    build:
      context: ./reporting
      dockerfile: Dockerfile
    image: mcp-reporting:latest
    container_name: mcp-reporting
    ports:
      - "5003:8000"
    networks:
      - agora-network
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "python", "-c", "import httpx; httpx.get('http://localhost:8000/health')"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 5s

  risk-enforcement:
    build:
      context: ./risk-enforcement
      dockerfile: Dockerfile
    image: mcp-risk-enforcement:latest
    container_name: mcp-risk-enforcement
    ports:
      - "5004:8000"
    networks:
      - agora-network
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "python", "-c", "import httpx; httpx.get('http://localhost:8000/health')"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 5s

  utilities:
    build:
      context: ./utilities
      dockerfile: Dockerfile
    image: mcp-utilities:latest
    container_name: mcp-utilities
    ports:
      - "5005:8000"
    networks:
      - agora-network
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "python", "-c", "import httpx; httpx.get('http://localhost:8000/health')"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 5s

networks:
  agora-network:
    driver: bridge
    name: agora-network

