---
alwaysApply: true
---

## C4 Architecture Diagram Guidelines

When editing `workspace.dsl`, follow these conventions:

### Tag System
- `Shared` - Components shared between OpenAI and OpenSource backends
- `OpenAI` - Specific to OpenAI Agents SDK implementation
- `OpenSource` - Specific to LangGraph implementation
- `NotImplemented` - Not yet implemented (renders with dashed border, red tint)

### Naming Conventions
- Prefix component names with `[Shared]`, `[OpenAI]`, or `[OpenSource]` as appropriate
- Use `[NOT IMPLEMENTED]` in descriptions for future features
- Use descriptive technology strings (e.g., "FastAPI + Uvicorn", "agents.Agent")

### Structure
```
model {
  # ACTORS - persons using the system
  # AGORA SYSTEM - main software system
    # HAI FRONTEND [Shared]
    # ORCHESTRATOR - unified (for C2)
    # ORCHESTRATOR OpenAI (for C3)
    # ORCHESTRATOR LangGraph (for C3)
    # MCP AGENT SERVERS [Shared]
    # MISSING CONTAINERS (NotImplemented)
  # MCP AGENT ECOSYSTEM - external system
}
```

### Available Views
- `C1_SystemContext` - System context diagram
- `C2_Containers` - Container diagram (unified orchestrator)
- `C3_HAI_Components` - HAI frontend components
- `C3_Orchestrator_OpenAI` - OpenAI implementation details
- `C3_Orchestrator_OpenSource` - LangGraph implementation details
- `C3_MCP_Components` - MCP server components

## Error Checking Protocol

After making ANY changes to files, always check for errors:

1. **After editing code files**: Run `read_lints` on the modified file(s) to check for linting errors
2. **After editing C4 diagrams** (`workspace.dsl`): Run `read_lints` to validate the DSL syntax
3. **If errors are found**: Fix them immediately before proceeding
4. **Never leave broken code**: Always ensure all linting errors are resolved

This applies to all file modifications including:
- Source code files (.ts, .tsx, .js, .py, etc.)
- Configuration files (.json, .yml, .yaml)
- C4 architecture files (.dsl)
- Any other editable files in the workspace
